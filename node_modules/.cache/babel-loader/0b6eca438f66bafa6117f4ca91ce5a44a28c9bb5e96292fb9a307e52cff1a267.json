{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\damva\\\\EducStation\\\\src\\\\components\\\\admin\\\\FloatingToolbar.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport Tooltip from '../ui/Tooltip'; // Importamos el componente Tooltip\n\n// Tamaños de fuente predeterminados como en Word\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst FONT_SIZES = [8, 9, 10, 11, 12, 14, 16, 18, 20, 22, 24, 26, 28, 36, 48, 72, 120];\n\n// FloatingToolbar - Barra de herramientas flotante para edición de texto\n// Aparece cuando se hace clic en el editor o se selecciona texto\nconst FloatingToolbar = ({\n  onFormatText,\n  activeFormats,\n  editorRef,\n  fontSize,\n  setFontSize\n}) => {\n  _s();\n  // Estados del componente\n  const [visible, setVisible] = useState(false);\n  const [position, setPosition] = useState({\n    top: 0,\n    left: 0\n  });\n  const [showFontSizeMenu, setShowFontSizeMenu] = useState(false);\n  const [customFontSize, setCustomFontSize] = useState('');\n  const [isEditingFontSize, setIsEditingFontSize] = useState(false);\n  const [savedSelection, setSavedSelection] = useState(null);\n  const [activeTooltip, setActiveTooltip] = useState(null);\n  const [isTyping, setIsTyping] = useState(false);\n  const typingTimeoutRef = useRef(null);\n\n  // Referencias\n  const toolbarRef = useRef(null);\n  const fontSizeMenuRef = useRef(null);\n  const customFontInputRef = useRef(null);\n\n  // Mostrar tooltip\n  const showTooltip = id => {\n    setActiveTooltip(id);\n  };\n\n  // Ocultar tooltip\n  const hideTooltip = () => {\n    setActiveTooltip(null);\n  };\n\n  // Estilos para la barra de herramientas\n  const styles = {\n    floatingBar: {\n      position: 'absolute',\n      zIndex: 1000,\n      display: visible ? 'flex' : 'none',\n      alignItems: 'center',\n      backgroundColor: 'rgb(209, 224, 217)',\n      borderRadius: '9px',\n      padding: '6px',\n      boxShadow: '0 3px 12px rgba(61, 42, 42, 0.2)',\n      transition: 'opacity 0.2s ease, transform 0.2s ease',\n      opacity: visible ? 1 : 0,\n      transform: visible ? 'translateX(-50%) translateY(0)' : 'translateX(-50%) translateY(10px)',\n      gap: '2px',\n      border: 'rgb(0, 0, 0)' // Añadir un borde sutil para mejorar la visibilidad\n    },\n    button: isActive => ({\n      background: 'none',\n      border: 'none',\n      borderRadius: '4px',\n      padding: '6px',\n      margin: '0 2px',\n      fontSize: '14px',\n      cursor: 'pointer',\n      color: isActive ? '#1b4fd9' : '#0b4444',\n      backgroundColor: isActive ? 'rgba(43, 87, 154, 0.1)' : 'transparent',\n      transition: 'all 0.2s ease',\n      display: 'flex',\n      alignItems: 'center',\n      justifyContent: 'center',\n      width: '28px',\n      height: '28px',\n      position: 'relative'\n    }),\n    fontSizeButton: {\n      display: 'flex',\n      alignItems: 'center',\n      background: 'none',\n      border: '1px solid #e1e7e6',\n      borderRadius: '4px',\n      padding: '4px 8px',\n      margin: '0 2px',\n      fontSize: '13px',\n      cursor: 'pointer',\n      color: '#333333',\n      // Color más oscuro para mejor legibilidad\n      fontWeight: 'normal',\n      transition: 'all 0.2s ease',\n      position: 'relative'\n    },\n    fontSizeInput: {\n      width: '40px',\n      border: '1px solid #2B579A',\n      borderRadius: '4px',\n      padding: '4px',\n      fontSize: '13px',\n      color: '#333333',\n      textAlign: 'center',\n      outline: 'none',\n      backgroundColor: 'white'\n    },\n    fontSizeMenu: {\n      position: 'absolute',\n      top: '100%',\n      left: '0',\n      backgroundColor: 'white',\n      border: '1px solid #cccccc',\n      borderRadius: '4px',\n      boxShadow: '0 4px 12px rgba(0, 0, 0, 0.15)',\n      maxHeight: '300px',\n      overflow: 'auto',\n      zIndex: 1001,\n      display: showFontSizeMenu ? 'block' : 'none',\n      marginTop: '2px',\n      width: '50px'\n    },\n    fontSizeItem: {\n      padding: '6px 12px',\n      cursor: 'pointer',\n      userSelect: 'none',\n      transition: 'background-color 0.2s',\n      textAlign: 'center',\n      color: '#0b4444'\n    },\n    customOption: {\n      borderTop: '1px solid #e1e7e6',\n      fontStyle: 'italic',\n      padding: '6px 12px',\n      cursor: 'pointer',\n      userSelect: 'none',\n      textAlign: 'center',\n      color: '#2B579A'\n    },\n    separator: {\n      width: '1px',\n      height: '20px',\n      margin: '0 4px',\n      backgroundColor: '#e1e7e6'\n    },\n    sizeControls: {\n      display: 'flex',\n      alignItems: 'center',\n      position: 'relative'\n    },\n    incrementButton: {\n      background: 'none',\n      border: 'none',\n      padding: '3px 5px',\n      cursor: 'pointer',\n      color: '#2B579A',\n      fontSize: '14px',\n      display: 'flex',\n      alignItems: 'center',\n      justifyContent: 'center',\n      borderRadius: '3px',\n      position: 'relative'\n    },\n    iconImage: {\n      width: '16px',\n      height: '16px'\n    }\n  };\n\n  // Función para guardar la selección actual\n  const saveSelection = () => {\n    const selection = window.getSelection();\n    if (selection.rangeCount > 0) {\n      const ranges = [];\n      for (let i = 0; i < selection.rangeCount; i++) {\n        ranges.push(selection.getRangeAt(i).cloneRange());\n      }\n      setSavedSelection(ranges);\n      return ranges;\n    }\n    return null;\n  };\n\n  // Función para restaurar la selección guardada\n  const restoreSelection = (ranges = savedSelection) => {\n    if (!ranges) return false;\n    const selection = window.getSelection();\n    selection.removeAllRanges();\n    ranges.forEach(range => {\n      selection.addRange(range);\n    });\n    return true;\n  };\n\n  // Establecer el estado de escritura\n  const handleTypingStart = () => {\n    setIsTyping(true);\n\n    // Limpiar cualquier timeout anterior\n    if (typingTimeoutRef.current) {\n      clearTimeout(typingTimeoutRef.current);\n    }\n\n    // Ocultar la barra mientras se escribe\n    setVisible(false);\n  };\n\n  // Función que se ejecuta cuando se detiene la escritura\n  const handleTypingStop = () => {\n    setIsTyping(false);\n    checkSelection();\n  };\n\n  // Función para verificar la selección de texto o si el editor está activo\n  const checkSelection = event => {\n    try {\n      // Si el usuario está escribiendo, no mostrar la barra\n      if (isTyping) {\n        return;\n      }\n      const selection = window.getSelection();\n\n      // Evitar ocultar la barra si estamos interactuando con elementos de la barra\n      if (toolbarRef.current && (toolbarRef.current.contains(document.activeElement) || event && toolbarRef.current.contains(event.target))) {\n        return;\n      }\n\n      // Prevent hiding the toolbar if interacting with the font size menu\n      if (fontSizeMenuRef.current && (fontSizeMenuRef.current.contains(document.activeElement) || selection.anchorNode && fontSizeMenuRef.current.contains(selection.anchorNode))) {\n        return;\n      }\n\n      // Verificar si el editor está activo\n      const isEditorActive = editorRef.current === document.activeElement;\n\n      // Verificar si tenemos una selección válida\n      const hasSelection = selection && !selection.isCollapsed && editorRef.current;\n\n      // Si ni el editor está activo ni hay selección, ocultar la barra\n      if (!isEditorActive && !hasSelection) {\n        setVisible(false);\n        setShowFontSizeMenu(false);\n        return;\n      }\n\n      // Verificar si la selección o el cursor está dentro del editor\n      let isInEditor = false;\n      if (isEditorActive) {\n        isInEditor = true;\n      } else if (hasSelection) {\n        const range = selection.getRangeAt(0);\n        let container = range.commonAncestorContainer;\n\n        // Si el contenedor es un nodo de texto, obtener su elemento padre\n        if (container.nodeType === 3) {\n          container = container.parentNode;\n        }\n\n        // Verificar si el contenedor o algún antecesor es el editor\n        let current = container;\n        while (current && !isInEditor) {\n          if (current === editorRef.current) {\n            isInEditor = true;\n          }\n          current = current.parentNode;\n        }\n      }\n      if (!isInEditor) {\n        setVisible(false);\n        setShowFontSizeMenu(false);\n        return;\n      }\n\n      // Calcular la posición de la barra\n      const editorRect = editorRef.current.getBoundingClientRect();\n\n      // Calculamos la altura de la barra (se estima en 40px si aún no está renderizada)\n      const toolbarHeight = toolbarRef.current ? toolbarRef.current.offsetHeight : 40;\n      const toolbarWidth = toolbarRef.current ? toolbarRef.current.offsetWidth : 320; // Estimación más precisa\n\n      let newPosition;\n      if (hasSelection) {\n        // Si hay selección, posicionar encima de la selección\n        const rect = selection.getRangeAt(0).getBoundingClientRect();\n        if (rect.width === 0) {\n          setVisible(false);\n          setShowFontSizeMenu(false);\n          return;\n        }\n        newPosition = {\n          // Posicionamos la barra encima de la línea de texto con un pequeño margen\n          top: rect.top - editorRect.top - toolbarHeight - 8,\n          // Centramos horizontalmente respecto a la selección\n          left: rect.left - editorRect.left + rect.width / 2\n        };\n      } else {\n        // Si solo está activo el editor sin selección, obtener la posición del cursor\n        const selection = window.getSelection();\n        if (selection.rangeCount > 0) {\n          const range = selection.getRangeAt(0);\n          const rect = range.getBoundingClientRect();\n          if (rect.width === 0) {\n            // Si el rect tiene ancho 0, es un cursor\n            // Usamos getClientRects para obtener una colección de rectángulos para cada línea\n            const rects = range.getClientRects();\n            if (rects.length > 0) {\n              const cursorRect = rects[0];\n              newPosition = {\n                top: cursorRect.top - editorRect.top - toolbarHeight - 8,\n                left: cursorRect.left - editorRect.left\n              };\n            } else {\n              // Fallback a una posición relativa a la selección\n              newPosition = {\n                top: 10,\n                left: Math.max(50, editorRect.width / 2) // Asegurar que no esté muy a la izquierda\n              };\n            }\n          } else {\n            // Si hay un rect con ancho, usamos su posición\n            newPosition = {\n              top: rect.top - editorRect.top - toolbarHeight - 8,\n              left: rect.left - editorRect.left + rect.width / 2\n            };\n          }\n        } else {\n          // Fallback a una posición por defecto\n          newPosition = {\n            top: 10,\n            left: editorRect.width / 2\n          };\n        }\n      }\n\n      // Ajustar para que no se salga del editor, con margen adicional\n      const SAFE_MARGIN = 20; // Margen de seguridad en píxeles\n\n      // Asegurar que la mitad izquierda de la barra no quede fuera\n      const halfToolbarWidth = toolbarWidth / 2;\n      if (newPosition.left < halfToolbarWidth + SAFE_MARGIN) {\n        newPosition.left = halfToolbarWidth + SAFE_MARGIN;\n      }\n\n      // Asegurar que la mitad derecha de la barra no quede fuera\n      if (newPosition.left + halfToolbarWidth > editorRect.width - SAFE_MARGIN) {\n        newPosition.left = editorRect.width - halfToolbarWidth - SAFE_MARGIN;\n      }\n\n      // Si no hay espacio arriba, colocar debajo del cursor o la selección\n      if (newPosition.top < 0) {\n        if (hasSelection) {\n          const rect = selection.getRangeAt(0).getBoundingClientRect();\n          newPosition.top = rect.bottom - editorRect.top + 8;\n        } else {\n          const range = selection.getRangeAt(0);\n          const rects = range.getClientRects();\n          if (rects.length > 0) {\n            newPosition.top = rects[0].bottom - editorRect.top + 8;\n          } else {\n            newPosition.top = 10; // Valor por defecto\n          }\n        }\n      }\n      setPosition(newPosition);\n      setVisible(true);\n\n      // Guardar la selección actual para poder restaurarla más tarde\n      saveSelection();\n    } catch (error) {\n      console.error('Error al verificar selección:', error);\n      setVisible(false);\n      setShowFontSizeMenu(false);\n    }\n  };\n\n  // Aplicar un tamaño de fuente específico\n  const applyFontSize = size => {\n    // Restaurar la selección antes de aplicar el formato\n    if (restoreSelection()) {\n      setFontSize(size); // Usar la función proporcionada por el componente padre\n    }\n    setShowFontSizeMenu(false);\n    setIsEditingFontSize(false);\n  };\n\n  // Maneja la entrada de texto para tamaño personalizado\n  const handleCustomFontSizeChange = e => {\n    // Solo permitir números y un punto decimal\n    const value = e.target.value.replace(/[^0-9.]/g, '');\n    // Evitar múltiples puntos decimales\n    if (value.split('.').length > 2) return;\n    setCustomFontSize(value);\n  };\n\n  // Maneja cuando el usuario confirma un tamaño personalizado\n  const handleCustomFontSizeSubmit = e => {\n    e.preventDefault();\n    if (customFontSize) {\n      const size = parseFloat(customFontSize);\n      // Validar que sea un número y esté en un rango razonable\n      if (!isNaN(size) && size >= 1 && size <= 500) {\n        applyFontSize(size);\n      }\n    }\n    setIsEditingFontSize(false);\n  };\n\n  // Incrementar/decrementar tamaño de fuente\n  const changeFontSize = increment => {\n    // Restaurar la selección antes de cambiar el tamaño\n    if (restoreSelection()) {\n      const currentIndex = FONT_SIZES.indexOf(fontSize);\n      if (increment && currentIndex < FONT_SIZES.length - 1) {\n        applyFontSize(FONT_SIZES[currentIndex + 1]);\n      } else if (!increment && currentIndex > 0) {\n        applyFontSize(FONT_SIZES[currentIndex - 1]);\n      }\n    }\n  };\n\n  // Activar el modo de edición de tamaño personalizado\n  const enableFontSizeEditing = e => {\n    e.stopPropagation(); // Evitar la propagación del evento\n\n    // Guardar la selección actual si aún no se ha guardado\n    if (!savedSelection) {\n      saveSelection();\n    }\n    setIsEditingFontSize(true);\n    setCustomFontSize(fontSize.toString());\n    setShowFontSizeMenu(false);\n\n    // Enfocar el input después de que se haya renderizado\n    setTimeout(() => {\n      if (customFontInputRef.current) {\n        customFontInputRef.current.focus();\n        customFontInputRef.current.select();\n      }\n    }, 50);\n  };\n\n  // Toggle del menú de tamaños\n  const toggleFontSizeMenu = e => {\n    e.stopPropagation(); // Evitar la propagación del evento\n\n    // Guardar la selección actual si aún no se ha guardado\n    if (!savedSelection) {\n      saveSelection();\n    }\n    setShowFontSizeMenu(!showFontSizeMenu);\n  };\n\n  // Actualizar el estado local cuando cambia el tamaño de fuente recibido\n  useEffect(() => {\n    if (isEditingFontSize) {\n      setCustomFontSize(fontSize.toString());\n    }\n  }, [fontSize, isEditingFontSize]);\n\n  // Mostrar la barra al hacer clic en el editor\n  useEffect(() => {\n    const handleEditorClick = () => {\n      if (editorRef.current && editorRef.current === document.activeElement) {\n        checkSelection();\n      }\n    };\n    if (editorRef.current) {\n      editorRef.current.addEventListener('click', handleEditorClick);\n    }\n    return () => {\n      if (editorRef.current) {\n        editorRef.current.removeEventListener('click', handleEditorClick);\n      }\n    };\n  }, [editorRef === null || editorRef === void 0 ? void 0 : editorRef.current]);\n\n  // Detectar escritura en el editor\n  useEffect(() => {\n    const handleKeyDown = () => {\n      handleTypingStart();\n    };\n    const handleKeyUp = e => {\n      // Limpiar el timeout anterior si existe\n      if (typingTimeoutRef.current) {\n        clearTimeout(typingTimeoutRef.current);\n      }\n\n      // Establecer un nuevo timeout\n      typingTimeoutRef.current = setTimeout(() => {\n        handleTypingStop();\n      }, 500); // Tiempo más corto para mejor respuesta\n    };\n    if (editorRef.current) {\n      editorRef.current.addEventListener('keydown', handleKeyDown);\n      editorRef.current.addEventListener('keyup', handleKeyUp);\n    }\n    return () => {\n      if (editorRef.current) {\n        editorRef.current.removeEventListener('keydown', handleKeyDown);\n        editorRef.current.removeEventListener('keyup', handleKeyUp);\n      }\n\n      // Limpiar el timeout si el componente se desmonta\n      if (typingTimeoutRef.current) {\n        clearTimeout(typingTimeoutRef.current);\n      }\n    };\n  }, [editorRef === null || editorRef === void 0 ? void 0 : editorRef.current]);\n\n  // Detectar cambios en la selección y en el foco del editor\n  useEffect(() => {\n    // No agregar event listeners si no hay editorRef\n    if (!editorRef || !editorRef.current) return;\n    document.addEventListener('selectionchange', checkSelection);\n    editorRef.current.addEventListener('mouseup', checkSelection);\n    editorRef.current.addEventListener('focus', checkSelection);\n\n    // Limpiar event listeners\n    return () => {\n      document.removeEventListener('selectionchange', checkSelection);\n      if (editorRef.current) {\n        editorRef.current.removeEventListener('mouseup', checkSelection);\n        editorRef.current.removeEventListener('focus', checkSelection);\n      }\n    };\n  }, [editorRef === null || editorRef === void 0 ? void 0 : editorRef.current]);\n\n  // Cerrar el menú cuando se hace clic fuera\n  useEffect(() => {\n    const handleClickOutside = event => {\n      if (fontSizeMenuRef.current && !fontSizeMenuRef.current.contains(event.target)) {\n        setShowFontSizeMenu(false);\n      }\n    };\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside);\n    };\n  }, []);\n\n  // Asegurarse de limpiar el timeout cuando el componente se desmonta\n  useEffect(() => {\n    return () => {\n      if (typingTimeoutRef.current) {\n        clearTimeout(typingTimeoutRef.current);\n      }\n    };\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    ref: toolbarRef,\n    style: {\n      ...styles.floatingBar,\n      top: `${position.top}px`,\n      left: `${position.left}px`,\n      transform: 'translateX(-50%)' // Centrar horizontalmente respecto al punto de referencia\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"button\", {\n      type: \"button\",\n      style: styles.button(activeFormats.bold),\n      onClick: () => {\n        restoreSelection();\n        onFormatText('bold');\n      },\n      onMouseEnter: () => showTooltip('bold'),\n      onMouseLeave: hideTooltip,\n      children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n        children: \"B\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 593,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Tooltip, {\n        isVisible: activeTooltip === 'bold',\n        text: \"Negrita\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 594,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 583,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      type: \"button\",\n      style: styles.button(activeFormats.italic),\n      onClick: () => {\n        restoreSelection();\n        onFormatText('italic');\n      },\n      onMouseEnter: () => showTooltip('italic'),\n      onMouseLeave: hideTooltip,\n      children: [/*#__PURE__*/_jsxDEV(\"em\", {\n        children: \"\\uFF29\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 610,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Tooltip, {\n        isVisible: activeTooltip === 'italic',\n        text: \"Cursiva\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 611,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 599,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      type: \"button\",\n      style: styles.button(activeFormats.underline),\n      onClick: () => {\n        restoreSelection();\n        onFormatText('underline');\n      },\n      onMouseEnter: () => showTooltip('underline'),\n      onMouseLeave: hideTooltip,\n      children: [/*#__PURE__*/_jsxDEV(\"u\", {\n        children: \"U\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 626,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Tooltip, {\n        isVisible: activeTooltip === 'underline',\n        text: \"Subrayado\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 627,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 616,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: styles.separator\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 633,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: styles.sizeControls,\n      children: [isEditingFontSize ?\n      /*#__PURE__*/\n      /* Campo de entrada para tamaño personalizado */\n      _jsxDEV(\"form\", {\n        onSubmit: e => {\n          e.preventDefault();\n          handleCustomFontSizeSubmit(e);\n        },\n        style: {\n          display: 'flex',\n          margin: '0 2px'\n        },\n        onClick: e => e.stopPropagation(),\n        children: /*#__PURE__*/_jsxDEV(\"input\", {\n          ref: customFontInputRef,\n          type: \"text\",\n          value: customFontSize,\n          onChange: handleCustomFontSizeChange,\n          onBlur: e => {\n            // Permitir un poco de tiempo para que se procese el clic antes de cerrar\n            setTimeout(() => {\n              handleCustomFontSizeSubmit(e);\n            }, 100);\n          },\n          style: styles.fontSizeInput,\n          onClick: e => e.stopPropagation()\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 647,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 639,\n        columnNumber: 11\n      }, this) :\n      /*#__PURE__*/\n      /* Botón de tamaño actual con desplegable */\n      _jsxDEV(\"div\", {\n        style: {\n          position: 'relative'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          style: styles.fontSizeButton,\n          onClick: enableFontSizeEditing // Al hacer clic directo, abre el editor de tamaño personalizado\n          ,\n          onDoubleClick: toggleFontSizeMenu // Doble clic muestra el menú\n          ,\n          onMouseEnter: () => showTooltip('fontSize'),\n          onMouseLeave: hideTooltip,\n          children: [fontSize, /*#__PURE__*/_jsxDEV(Tooltip, {\n            isVisible: activeTooltip === 'fontSize',\n            text: \"Tama\\xF1o de fuente\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 674,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 665,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          ref: fontSizeMenuRef,\n          style: styles.fontSizeMenu,\n          onClick: e => e.stopPropagation(),\n          children: [FONT_SIZES.map(size => /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              ...styles.fontSizeItem,\n              backgroundColor: fontSize === size ? 'rgba(43, 87, 154, 0.1)' : 'transparent',\n              fontWeight: fontSize === size ? 'bold' : 'normal'\n            },\n            onClick: e => {\n              e.stopPropagation();\n              applyFontSize(size);\n            },\n            onMouseEnter: e => {\n              e.currentTarget.style.backgroundColor = 'rgba(43, 87, 154, 0.1)';\n            },\n            onMouseLeave: e => {\n              if (fontSize !== size) {\n                e.currentTarget.style.backgroundColor = 'transparent';\n              }\n            },\n            children: size\n          }, size, false, {\n            fileName: _jsxFileName,\n            lineNumber: 687,\n            columnNumber: 17\n          }, this)), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: styles.customOption,\n            onClick: e => {\n              e.stopPropagation();\n              enableFontSizeEditing(e);\n            },\n            onMouseEnter: e => {\n              e.currentTarget.style.backgroundColor = 'rgba(43, 87, 154, 0.1)';\n            },\n            onMouseLeave: e => {\n              e.currentTarget.style.backgroundColor = 'transparent';\n            },\n            children: \"Personalizado\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 713,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 681,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 664,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          style: styles.incrementButton,\n          onClick: e => {\n            e.stopPropagation();\n            changeFontSize(true);\n          },\n          onMouseEnter: () => showTooltip('increaseFontSize'),\n          onMouseLeave: hideTooltip,\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            style: {\n              color: '#0b4444'\n            },\n            children: \"\\u25B2\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 744,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Tooltip, {\n            isVisible: activeTooltip === 'increaseFontSize',\n            text: \"Aumentar tama\\xF1o\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 745,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 734,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          style: styles.incrementButton,\n          onClick: e => {\n            e.stopPropagation();\n            changeFontSize(false);\n          },\n          onMouseEnter: () => showTooltip('decreaseFontSize'),\n          onMouseLeave: hideTooltip,\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            style: {\n              color: '#0b4444'\n            },\n            children: \"\\u25BC\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 760,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Tooltip, {\n            isVisible: activeTooltip === 'decreaseFontSize',\n            text: \"Reducir tama\\xF1o\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 761,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 750,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 733,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 636,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: styles.separator\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 769,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      type: \"button\",\n      style: styles.button(false),\n      onClick: () => {\n        restoreSelection();\n        onFormatText('textColor');\n      },\n      onMouseEnter: () => showTooltip('textColor'),\n      onMouseLeave: hideTooltip,\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        style: {\n          color: '#0b4444'\n        },\n        children: \"A\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 782,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Tooltip, {\n        isVisible: activeTooltip === 'textColor',\n        text: \"Color de texto\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 785,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 772,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      type: \"button\",\n      style: styles.button(activeFormats.unorderedList),\n      onClick: () => {\n        restoreSelection();\n        onFormatText('unorderedList');\n      },\n      onMouseEnter: () => showTooltip('unorderedList'),\n      onMouseLeave: hideTooltip,\n      children: [\"\\u2022\", /*#__PURE__*/_jsxDEV(Tooltip, {\n        isVisible: activeTooltip === 'unorderedList',\n        text: \"Lista con vi\\xF1etas\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 801,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 790,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      type: \"button\",\n      style: styles.button(activeFormats.link),\n      onClick: () => {\n        restoreSelection();\n        onFormatText('link');\n      },\n      onMouseEnter: () => showTooltip('link'),\n      onMouseLeave: hideTooltip,\n      children: [/*#__PURE__*/_jsxDEV(\"img\", {\n        src: \"/assets/images/icons/LINK_icon.png\",\n        style: styles.iconImage\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 816,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Tooltip, {\n        isVisible: activeTooltip === 'link',\n        text: \"Insertar enlace\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 817,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 806,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      type: \"button\",\n      style: styles.button(false),\n      onClick: () => {\n        restoreSelection();\n        onFormatText('image');\n      },\n      onMouseEnter: () => showTooltip('image'),\n      onMouseLeave: hideTooltip,\n      children: [/*#__PURE__*/_jsxDEV(\"img\", {\n        src: \"/assets/images/icons/IMG_icon.png\",\n        style: styles.iconImage\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 833,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Tooltip, {\n        isVisible: activeTooltip === 'image',\n        text: \"Insertar imagen\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 834,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 823,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 573,\n    columnNumber: 5\n  }, this);\n};\n_s(FloatingToolbar, \"Sai/W4BZVLtElyiQNwHTb/7xWFQ=\");\n_c = FloatingToolbar;\nexport default FloatingToolbar;\nvar _c;\n$RefreshReg$(_c, \"FloatingToolbar\");","map":{"version":3,"names":["React","useState","useEffect","useRef","Tooltip","jsxDEV","_jsxDEV","FONT_SIZES","FloatingToolbar","onFormatText","activeFormats","editorRef","fontSize","setFontSize","_s","visible","setVisible","position","setPosition","top","left","showFontSizeMenu","setShowFontSizeMenu","customFontSize","setCustomFontSize","isEditingFontSize","setIsEditingFontSize","savedSelection","setSavedSelection","activeTooltip","setActiveTooltip","isTyping","setIsTyping","typingTimeoutRef","toolbarRef","fontSizeMenuRef","customFontInputRef","showTooltip","id","hideTooltip","styles","floatingBar","zIndex","display","alignItems","backgroundColor","borderRadius","padding","boxShadow","transition","opacity","transform","gap","border","button","isActive","background","margin","cursor","color","justifyContent","width","height","fontSizeButton","fontWeight","fontSizeInput","textAlign","outline","fontSizeMenu","maxHeight","overflow","marginTop","fontSizeItem","userSelect","customOption","borderTop","fontStyle","separator","sizeControls","incrementButton","iconImage","saveSelection","selection","window","getSelection","rangeCount","ranges","i","push","getRangeAt","cloneRange","restoreSelection","removeAllRanges","forEach","range","addRange","handleTypingStart","current","clearTimeout","handleTypingStop","checkSelection","event","contains","document","activeElement","target","anchorNode","isEditorActive","hasSelection","isCollapsed","isInEditor","container","commonAncestorContainer","nodeType","parentNode","editorRect","getBoundingClientRect","toolbarHeight","offsetHeight","toolbarWidth","offsetWidth","newPosition","rect","rects","getClientRects","length","cursorRect","Math","max","SAFE_MARGIN","halfToolbarWidth","bottom","error","console","applyFontSize","size","handleCustomFontSizeChange","e","value","replace","split","handleCustomFontSizeSubmit","preventDefault","parseFloat","isNaN","changeFontSize","increment","currentIndex","indexOf","enableFontSizeEditing","stopPropagation","toString","setTimeout","focus","select","toggleFontSizeMenu","handleEditorClick","addEventListener","removeEventListener","handleKeyDown","handleKeyUp","handleClickOutside","ref","style","children","type","bold","onClick","onMouseEnter","onMouseLeave","fileName","_jsxFileName","lineNumber","columnNumber","isVisible","text","italic","underline","onSubmit","onChange","onBlur","onDoubleClick","map","currentTarget","unorderedList","link","src","_c","$RefreshReg$"],"sources":["C:/Users/damva/EducStation/src/components/admin/FloatingToolbar.jsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport Tooltip from '../ui/Tooltip'; // Importamos el componente Tooltip\r\n\r\n// Tamaños de fuente predeterminados como en Word\r\nconst FONT_SIZES = [8, 9, 10, 11, 12, 14, 16, 18, 20, 22, 24, 26, 28, 36, 48, 72,120];\r\n\r\n// FloatingToolbar - Barra de herramientas flotante para edición de texto\r\n// Aparece cuando se hace clic en el editor o se selecciona texto\r\nconst FloatingToolbar = ({ onFormatText, activeFormats, editorRef, fontSize, setFontSize }) => {\r\n  // Estados del componente\r\n  const [visible, setVisible] = useState(false);\r\n  const [position, setPosition] = useState({ top: 0, left: 0 });\r\n  const [showFontSizeMenu, setShowFontSizeMenu] = useState(false);\r\n  const [customFontSize, setCustomFontSize] = useState('');\r\n  const [isEditingFontSize, setIsEditingFontSize] = useState(false);\r\n  const [savedSelection, setSavedSelection] = useState(null);\r\n  const [activeTooltip, setActiveTooltip] = useState(null);\r\n  const [isTyping, setIsTyping] = useState(false);\r\n  const typingTimeoutRef = useRef(null);\r\n  \r\n  // Referencias\r\n  const toolbarRef = useRef(null);\r\n  const fontSizeMenuRef = useRef(null);\r\n  const customFontInputRef = useRef(null);\r\n  \r\n  // Mostrar tooltip\r\n  const showTooltip = (id) => {\r\n    setActiveTooltip(id);\r\n  };\r\n\r\n  // Ocultar tooltip\r\n  const hideTooltip = () => {\r\n    setActiveTooltip(null);\r\n  };\r\n  \r\n  // Estilos para la barra de herramientas\r\n  const styles = {\r\n    floatingBar: {\r\n      position: 'absolute',\r\n      zIndex: 1000,\r\n      display: visible ? 'flex' : 'none',\r\n      alignItems: 'center',\r\n      backgroundColor:  'rgb(209, 224, 217)',\r\n      borderRadius: '9px',\r\n      padding: '6px',\r\n      boxShadow: '0 3px 12px rgba(61, 42, 42, 0.2)',\r\n      transition: 'opacity 0.2s ease, transform 0.2s ease',\r\n      opacity: visible ? 1 : 0,\r\n      transform: visible ? 'translateX(-50%) translateY(0)' : 'translateX(-50%) translateY(10px)',\r\n      gap: '2px',\r\n      border: 'rgb(0, 0, 0)' // Añadir un borde sutil para mejorar la visibilidad\r\n    },\r\n    button: (isActive) => ({\r\n      background: 'none',\r\n      border: 'none',\r\n      borderRadius: '4px',\r\n      padding: '6px',\r\n      margin: '0 2px',\r\n      fontSize: '14px',\r\n      cursor: 'pointer',\r\n      color: isActive ? '#1b4fd9' : '#0b4444',\r\n      backgroundColor: isActive ? 'rgba(43, 87, 154, 0.1)' : 'transparent',\r\n      transition: 'all 0.2s ease',\r\n      display: 'flex',\r\n      alignItems: 'center',\r\n      justifyContent: 'center',\r\n      width: '28px',\r\n      height: '28px',\r\n      position: 'relative'\r\n    }),\r\n    fontSizeButton: {\r\n      display: 'flex',\r\n      alignItems: 'center',\r\n      background: 'none',\r\n      border: '1px solid #e1e7e6',\r\n      borderRadius: '4px',\r\n      padding: '4px 8px',\r\n      margin: '0 2px',\r\n      fontSize: '13px',\r\n      cursor: 'pointer',\r\n      color: '#333333', // Color más oscuro para mejor legibilidad\r\n      fontWeight: 'normal',\r\n      transition: 'all 0.2s ease',\r\n      position: 'relative'\r\n    },\r\n    fontSizeInput: {\r\n      width: '40px',\r\n      border: '1px solid #2B579A',\r\n      borderRadius: '4px',\r\n      padding: '4px',\r\n      fontSize: '13px',\r\n      color: '#333333',\r\n      textAlign: 'center',\r\n      outline: 'none',\r\n      backgroundColor: 'white'\r\n    },\r\n    fontSizeMenu: {\r\n      position: 'absolute',\r\n      top: '100%',\r\n      left: '0',\r\n      backgroundColor: 'white',\r\n      border: '1px solid #cccccc',\r\n      borderRadius: '4px',\r\n      boxShadow: '0 4px 12px rgba(0, 0, 0, 0.15)',\r\n      maxHeight: '300px',\r\n      overflow: 'auto',\r\n      zIndex: 1001,\r\n      display: showFontSizeMenu ? 'block' : 'none',\r\n      marginTop: '2px',\r\n      width: '50px'\r\n    },\r\n    fontSizeItem: {\r\n      padding: '6px 12px',\r\n      cursor: 'pointer',\r\n      userSelect: 'none',\r\n      transition: 'background-color 0.2s',\r\n      textAlign: 'center',\r\n      color: '#0b4444'\r\n    },\r\n    customOption: {\r\n      borderTop: '1px solid #e1e7e6', \r\n      fontStyle: 'italic',\r\n      padding: '6px 12px',\r\n      cursor: 'pointer',\r\n      userSelect: 'none',\r\n      textAlign: 'center',\r\n      color: '#2B579A'\r\n    },\r\n    separator: {\r\n      width: '1px',\r\n      height: '20px',\r\n      margin: '0 4px',\r\n      backgroundColor: '#e1e7e6'\r\n    },\r\n    sizeControls: {\r\n      display: 'flex',\r\n      alignItems: 'center',\r\n      position: 'relative'\r\n    },\r\n    incrementButton: {\r\n      background: 'none',\r\n      border: 'none',\r\n      padding: '3px 5px',\r\n      cursor: 'pointer',\r\n      color: '#2B579A', \r\n      fontSize: '14px',\r\n      display: 'flex',\r\n      alignItems: 'center',\r\n      justifyContent: 'center',\r\n      borderRadius: '3px',\r\n      position: 'relative'\r\n    },\r\n    iconImage: {\r\n      width: '16px',\r\n      height: '16px'\r\n    }\r\n  };\r\n\r\n  // Función para guardar la selección actual\r\n  const saveSelection = () => {\r\n    const selection = window.getSelection();\r\n    if (selection.rangeCount > 0) {\r\n      const ranges = [];\r\n      for (let i = 0; i < selection.rangeCount; i++) {\r\n        ranges.push(selection.getRangeAt(i).cloneRange());\r\n      }\r\n      setSavedSelection(ranges);\r\n      return ranges;\r\n    }\r\n    return null;\r\n  };\r\n\r\n  // Función para restaurar la selección guardada\r\n  const restoreSelection = (ranges = savedSelection) => {\r\n    if (!ranges) return false;\r\n    \r\n    const selection = window.getSelection();\r\n    selection.removeAllRanges();\r\n    \r\n    ranges.forEach(range => {\r\n      selection.addRange(range);\r\n    });\r\n    \r\n    return true;\r\n  };\r\n\r\n  // Establecer el estado de escritura\r\n  const handleTypingStart = () => {\r\n    setIsTyping(true);\r\n    \r\n    // Limpiar cualquier timeout anterior\r\n    if (typingTimeoutRef.current) {\r\n      clearTimeout(typingTimeoutRef.current);\r\n    }\r\n    \r\n    // Ocultar la barra mientras se escribe\r\n    setVisible(false);\r\n  };\r\n  \r\n  // Función que se ejecuta cuando se detiene la escritura\r\n  const handleTypingStop = () => {\r\n    setIsTyping(false);\r\n    checkSelection();\r\n  };\r\n\r\n  // Función para verificar la selección de texto o si el editor está activo\r\n  const checkSelection = (event) => {\r\n    try {\r\n      // Si el usuario está escribiendo, no mostrar la barra\r\n      if (isTyping) {\r\n        return;\r\n      }\r\n      \r\n      const selection = window.getSelection();\r\n\r\n      // Evitar ocultar la barra si estamos interactuando con elementos de la barra\r\n      if (\r\n        toolbarRef.current &&\r\n        (toolbarRef.current.contains(document.activeElement) ||\r\n         (event && toolbarRef.current.contains(event.target)))\r\n      ) {\r\n        return;\r\n      }\r\n\r\n      // Prevent hiding the toolbar if interacting with the font size menu\r\n      if (\r\n        fontSizeMenuRef.current &&\r\n        (fontSizeMenuRef.current.contains(document.activeElement) ||\r\n         (selection.anchorNode && fontSizeMenuRef.current.contains(selection.anchorNode)))\r\n      ) {\r\n        return;\r\n      }\r\n      \r\n      // Verificar si el editor está activo\r\n      const isEditorActive = editorRef.current === document.activeElement;\r\n      \r\n      // Verificar si tenemos una selección válida\r\n      const hasSelection = selection && !selection.isCollapsed && editorRef.current;\r\n      \r\n      // Si ni el editor está activo ni hay selección, ocultar la barra\r\n      if (!isEditorActive && !hasSelection) {\r\n        setVisible(false);\r\n        setShowFontSizeMenu(false);\r\n        return;\r\n      }\r\n      \r\n      // Verificar si la selección o el cursor está dentro del editor\r\n      let isInEditor = false;\r\n      \r\n      if (isEditorActive) {\r\n        isInEditor = true;\r\n      } else if (hasSelection) {\r\n        const range = selection.getRangeAt(0);\r\n        let container = range.commonAncestorContainer;\r\n        \r\n        // Si el contenedor es un nodo de texto, obtener su elemento padre\r\n        if (container.nodeType === 3) {\r\n          container = container.parentNode;\r\n        }\r\n        \r\n        // Verificar si el contenedor o algún antecesor es el editor\r\n        let current = container;\r\n        \r\n        while (current && !isInEditor) {\r\n          if (current === editorRef.current) {\r\n            isInEditor = true;\r\n          }\r\n          current = current.parentNode;\r\n        }\r\n      }\r\n      \r\n      if (!isInEditor) {\r\n        setVisible(false);\r\n        setShowFontSizeMenu(false);\r\n        return;\r\n      }\r\n      \r\n      // Calcular la posición de la barra\r\n      const editorRect = editorRef.current.getBoundingClientRect();\r\n      \r\n      // Calculamos la altura de la barra (se estima en 40px si aún no está renderizada)\r\n      const toolbarHeight = toolbarRef.current ? toolbarRef.current.offsetHeight : 40;\r\n      const toolbarWidth = toolbarRef.current ? toolbarRef.current.offsetWidth : 320; // Estimación más precisa\r\n      \r\n      let newPosition;\r\n      \r\n      if (hasSelection) {\r\n        // Si hay selección, posicionar encima de la selección\r\n        const rect = selection.getRangeAt(0).getBoundingClientRect();\r\n        \r\n        if (rect.width === 0) {\r\n          setVisible(false);\r\n          setShowFontSizeMenu(false);\r\n          return;\r\n        }\r\n        \r\n        newPosition = {\r\n          // Posicionamos la barra encima de la línea de texto con un pequeño margen\r\n          top: rect.top - editorRect.top - toolbarHeight - 8,\r\n          // Centramos horizontalmente respecto a la selección\r\n          left: rect.left - editorRect.left + (rect.width / 2)\r\n        };\r\n      } else {\r\n        // Si solo está activo el editor sin selección, obtener la posición del cursor\r\n        const selection = window.getSelection();\r\n        if (selection.rangeCount > 0) {\r\n          const range = selection.getRangeAt(0);\r\n          const rect = range.getBoundingClientRect();\r\n          \r\n          if (rect.width === 0) {\r\n            // Si el rect tiene ancho 0, es un cursor\r\n            // Usamos getClientRects para obtener una colección de rectángulos para cada línea\r\n            const rects = range.getClientRects();\r\n            if (rects.length > 0) {\r\n              const cursorRect = rects[0];\r\n              newPosition = {\r\n                top: cursorRect.top - editorRect.top - toolbarHeight - 8,\r\n                left: cursorRect.left - editorRect.left\r\n              };\r\n            } else {\r\n              // Fallback a una posición relativa a la selección\r\n              newPosition = {\r\n                top: 10,\r\n                left: Math.max(50, editorRect.width / 2) // Asegurar que no esté muy a la izquierda\r\n              };\r\n            }\r\n          } else {\r\n            // Si hay un rect con ancho, usamos su posición\r\n            newPosition = {\r\n              top: rect.top - editorRect.top - toolbarHeight - 8,\r\n              left: rect.left - editorRect.left + (rect.width / 2)\r\n            };\r\n          }\r\n        } else {\r\n          // Fallback a una posición por defecto\r\n          newPosition = {\r\n            top: 10,\r\n            left: editorRect.width / 2\r\n          };\r\n        }\r\n      }\r\n      \r\n      // Ajustar para que no se salga del editor, con margen adicional\r\n      const SAFE_MARGIN = 20; // Margen de seguridad en píxeles\r\n      \r\n      // Asegurar que la mitad izquierda de la barra no quede fuera\r\n      const halfToolbarWidth = toolbarWidth / 2;\r\n      if (newPosition.left < halfToolbarWidth + SAFE_MARGIN) {\r\n        newPosition.left = halfToolbarWidth + SAFE_MARGIN;\r\n      }\r\n      \r\n      // Asegurar que la mitad derecha de la barra no quede fuera\r\n      if (newPosition.left + halfToolbarWidth > editorRect.width - SAFE_MARGIN) {\r\n        newPosition.left = editorRect.width - halfToolbarWidth - SAFE_MARGIN;\r\n      }\r\n      \r\n      // Si no hay espacio arriba, colocar debajo del cursor o la selección\r\n      if (newPosition.top < 0) {\r\n        if (hasSelection) {\r\n          const rect = selection.getRangeAt(0).getBoundingClientRect();\r\n          newPosition.top = rect.bottom - editorRect.top + 8;\r\n        } else {\r\n          const range = selection.getRangeAt(0);\r\n          const rects = range.getClientRects();\r\n          if (rects.length > 0) {\r\n            newPosition.top = rects[0].bottom - editorRect.top + 8;\r\n          } else {\r\n            newPosition.top = 10; // Valor por defecto\r\n          }\r\n        }\r\n      }\r\n      \r\n      setPosition(newPosition);\r\n      setVisible(true);\r\n      \r\n      // Guardar la selección actual para poder restaurarla más tarde\r\n      saveSelection();\r\n    } catch (error) {\r\n      console.error('Error al verificar selección:', error);\r\n      setVisible(false);\r\n      setShowFontSizeMenu(false);\r\n    }\r\n  };\r\n\r\n  // Aplicar un tamaño de fuente específico\r\n  const applyFontSize = (size) => {\r\n    // Restaurar la selección antes de aplicar el formato\r\n    if (restoreSelection()) {\r\n      setFontSize(size); // Usar la función proporcionada por el componente padre\r\n    }\r\n    setShowFontSizeMenu(false);\r\n    setIsEditingFontSize(false);\r\n  };\r\n\r\n  // Maneja la entrada de texto para tamaño personalizado\r\n  const handleCustomFontSizeChange = (e) => {\r\n    // Solo permitir números y un punto decimal\r\n    const value = e.target.value.replace(/[^0-9.]/g, '');\r\n    // Evitar múltiples puntos decimales\r\n    if (value.split('.').length > 2) return;\r\n    \r\n    setCustomFontSize(value);\r\n  };\r\n\r\n  // Maneja cuando el usuario confirma un tamaño personalizado\r\n  const handleCustomFontSizeSubmit = (e) => {\r\n    e.preventDefault();\r\n    \r\n    if (customFontSize) {\r\n      const size = parseFloat(customFontSize);\r\n      // Validar que sea un número y esté en un rango razonable\r\n      if (!isNaN(size) && size >= 1 && size <= 500) {\r\n        applyFontSize(size);\r\n      }\r\n    }\r\n    \r\n    setIsEditingFontSize(false);\r\n  };\r\n\r\n  // Incrementar/decrementar tamaño de fuente\r\n  const changeFontSize = (increment) => {\r\n    // Restaurar la selección antes de cambiar el tamaño\r\n    if (restoreSelection()) {\r\n      const currentIndex = FONT_SIZES.indexOf(fontSize);\r\n      \r\n      if (increment && currentIndex < FONT_SIZES.length - 1) {\r\n        applyFontSize(FONT_SIZES[currentIndex + 1]);\r\n      } else if (!increment && currentIndex > 0) {\r\n        applyFontSize(FONT_SIZES[currentIndex - 1]);\r\n      }\r\n    }\r\n  };\r\n  \r\n  // Activar el modo de edición de tamaño personalizado\r\n  const enableFontSizeEditing = (e) => {\r\n    e.stopPropagation(); // Evitar la propagación del evento\r\n    \r\n    // Guardar la selección actual si aún no se ha guardado\r\n    if (!savedSelection) {\r\n      saveSelection();\r\n    }\r\n    \r\n    setIsEditingFontSize(true);\r\n    setCustomFontSize(fontSize.toString());\r\n    setShowFontSizeMenu(false);\r\n    \r\n    // Enfocar el input después de que se haya renderizado\r\n    setTimeout(() => {\r\n      if (customFontInputRef.current) {\r\n        customFontInputRef.current.focus();\r\n        customFontInputRef.current.select();\r\n      }\r\n    }, 50);\r\n  };\r\n  \r\n  // Toggle del menú de tamaños\r\n  const toggleFontSizeMenu = (e) => {\r\n    e.stopPropagation(); // Evitar la propagación del evento\r\n    \r\n    // Guardar la selección actual si aún no se ha guardado\r\n    if (!savedSelection) {\r\n      saveSelection();\r\n    }\r\n    \r\n    setShowFontSizeMenu(!showFontSizeMenu);\r\n  };\r\n\r\n  // Actualizar el estado local cuando cambia el tamaño de fuente recibido\r\n  useEffect(() => {\r\n    if (isEditingFontSize) {\r\n      setCustomFontSize(fontSize.toString());\r\n    }\r\n  }, [fontSize, isEditingFontSize]);\r\n  \r\n  // Mostrar la barra al hacer clic en el editor\r\n  useEffect(() => {\r\n    const handleEditorClick = () => {\r\n      if (editorRef.current && editorRef.current === document.activeElement) {\r\n        checkSelection();\r\n      }\r\n    };\r\n    \r\n    if (editorRef.current) {\r\n      editorRef.current.addEventListener('click', handleEditorClick);\r\n    }\r\n    \r\n    return () => {\r\n      if (editorRef.current) {\r\n        editorRef.current.removeEventListener('click', handleEditorClick);\r\n      }\r\n    };\r\n  }, [editorRef?.current]);\r\n\r\n  // Detectar escritura en el editor\r\n  useEffect(() => {\r\n    const handleKeyDown = () => {\r\n      handleTypingStart();\r\n    };\r\n    \r\n    const handleKeyUp = (e) => {\r\n      // Limpiar el timeout anterior si existe\r\n      if (typingTimeoutRef.current) {\r\n        clearTimeout(typingTimeoutRef.current);\r\n      }\r\n      \r\n      // Establecer un nuevo timeout\r\n      typingTimeoutRef.current = setTimeout(() => {\r\n        handleTypingStop();\r\n      }, 500); // Tiempo más corto para mejor respuesta\r\n    };\r\n    \r\n    if (editorRef.current) {\r\n      editorRef.current.addEventListener('keydown', handleKeyDown);\r\n      editorRef.current.addEventListener('keyup', handleKeyUp);\r\n    }\r\n    \r\n    return () => {\r\n      if (editorRef.current) {\r\n        editorRef.current.removeEventListener('keydown', handleKeyDown);\r\n        editorRef.current.removeEventListener('keyup', handleKeyUp);\r\n      }\r\n      \r\n      // Limpiar el timeout si el componente se desmonta\r\n      if (typingTimeoutRef.current) {\r\n        clearTimeout(typingTimeoutRef.current);\r\n      }\r\n    };\r\n  }, [editorRef?.current]);\r\n\r\n  // Detectar cambios en la selección y en el foco del editor\r\n  useEffect(() => {\r\n    // No agregar event listeners si no hay editorRef\r\n    if (!editorRef || !editorRef.current) return;\r\n    \r\n    document.addEventListener('selectionchange', checkSelection);\r\n    editorRef.current.addEventListener('mouseup', checkSelection);\r\n    editorRef.current.addEventListener('focus', checkSelection);\r\n    \r\n    // Limpiar event listeners\r\n    return () => {\r\n      document.removeEventListener('selectionchange', checkSelection);\r\n      if (editorRef.current) {\r\n        editorRef.current.removeEventListener('mouseup', checkSelection);\r\n        editorRef.current.removeEventListener('focus', checkSelection);\r\n      }\r\n    };\r\n  }, [editorRef?.current]);\r\n\r\n  // Cerrar el menú cuando se hace clic fuera\r\n  useEffect(() => {\r\n    const handleClickOutside = (event) => {\r\n      if (fontSizeMenuRef.current && !fontSizeMenuRef.current.contains(event.target)) {\r\n        setShowFontSizeMenu(false);\r\n      }\r\n    };\r\n    \r\n    document.addEventListener('mousedown', handleClickOutside);\r\n    return () => {\r\n      document.removeEventListener('mousedown', handleClickOutside);\r\n    };\r\n  }, []);\r\n\r\n  // Asegurarse de limpiar el timeout cuando el componente se desmonta\r\n  useEffect(() => {\r\n    return () => {\r\n      if (typingTimeoutRef.current) {\r\n        clearTimeout(typingTimeoutRef.current);\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  return (\r\n    <div \r\n      ref={toolbarRef}\r\n      style={{\r\n        ...styles.floatingBar,\r\n        top: `${position.top}px`,\r\n        left: `${position.left}px`,\r\n        transform: 'translateX(-50%)' // Centrar horizontalmente respecto al punto de referencia\r\n      }}\r\n    >\r\n      {/* Formato de texto básico */}\r\n      <button \r\n        type=\"button\"\r\n        style={styles.button(activeFormats.bold)}\r\n        onClick={() => {\r\n          restoreSelection();\r\n          onFormatText('bold');\r\n        }}\r\n        onMouseEnter={() => showTooltip('bold')}\r\n        onMouseLeave={hideTooltip}\r\n      >\r\n        <strong>B</strong>\r\n        <Tooltip\r\n          isVisible={activeTooltip === 'bold'}\r\n          text=\"Negrita\"\r\n        />\r\n      </button>\r\n      <button \r\n        type=\"button\"\r\n\r\n        style={styles.button(activeFormats.italic)}\r\n        onClick={() => {\r\n          restoreSelection();\r\n          onFormatText('italic');\r\n        }}\r\n        onMouseEnter={() => showTooltip('italic')}\r\n        onMouseLeave={hideTooltip}\r\n      >\r\n        <em>Ｉ</em>\r\n        <Tooltip\r\n          isVisible={activeTooltip === 'italic'}\r\n          text=\"Cursiva\"\r\n        />\r\n      </button>\r\n      <button \r\n        type=\"button\"\r\n        style={styles.button(activeFormats.underline)}\r\n        onClick={() => {\r\n          restoreSelection();\r\n          onFormatText('underline');\r\n        }}\r\n        onMouseEnter={() => showTooltip('underline')}\r\n        onMouseLeave={hideTooltip}\r\n      >\r\n        <u>U</u>\r\n        <Tooltip\r\n          isVisible={activeTooltip === 'underline'}\r\n          text=\"Subrayado\"\r\n        />\r\n      </button>\r\n      \r\n      <div style={styles.separator} />\r\n      \r\n      {/* Selector de tamaño de fuente tipo Word con opción personalizada */}\r\n      <div style={styles.sizeControls}>\r\n        {isEditingFontSize ? (\r\n          /* Campo de entrada para tamaño personalizado */\r\n          <form \r\n            onSubmit={(e) => {\r\n              e.preventDefault();\r\n              handleCustomFontSizeSubmit(e);\r\n            }} \r\n            style={{ display: 'flex', margin: '0 2px' }}\r\n            onClick={(e) => e.stopPropagation()}\r\n          >\r\n            <input\r\n              ref={customFontInputRef}\r\n              type=\"text\"\r\n              value={customFontSize}\r\n              onChange={handleCustomFontSizeChange}\r\n              onBlur={(e) => {\r\n                // Permitir un poco de tiempo para que se procese el clic antes de cerrar\r\n                setTimeout(() => {\r\n                  handleCustomFontSizeSubmit(e);\r\n                }, 100);\r\n              }}\r\n              style={styles.fontSizeInput}\r\n              onClick={(e) => e.stopPropagation()}\r\n            />\r\n          </form>\r\n        ) : (\r\n          /* Botón de tamaño actual con desplegable */\r\n          <div style={{ position: 'relative' }}>\r\n            <button\r\n              type=\"button\"\r\n              style={styles.fontSizeButton}\r\n              onClick={enableFontSizeEditing} // Al hacer clic directo, abre el editor de tamaño personalizado\r\n              onDoubleClick={toggleFontSizeMenu} // Doble clic muestra el menú\r\n              onMouseEnter={() => showTooltip('fontSize')}\r\n              onMouseLeave={hideTooltip}\r\n            >\r\n              {fontSize}\r\n              <Tooltip\r\n                isVisible={activeTooltip === 'fontSize'}\r\n                text=\"Tamaño de fuente\"\r\n              />\r\n            </button>\r\n            \r\n            {/* Menú desplegable con tamaños predefinidos */}\r\n            <div \r\n              ref={fontSizeMenuRef}\r\n              style={styles.fontSizeMenu}\r\n              onClick={(e) => e.stopPropagation()}\r\n            >\r\n              {FONT_SIZES.map(size => (\r\n                <div\r\n                  key={size}\r\n                  style={{\r\n                    ...styles.fontSizeItem,\r\n                    backgroundColor: fontSize === size \r\n                      ? 'rgba(43, 87, 154, 0.1)' \r\n                      : 'transparent',\r\n                    fontWeight: fontSize === size ? 'bold' : 'normal'\r\n                  }}\r\n                  onClick={(e) => {\r\n                    e.stopPropagation();\r\n                    applyFontSize(size);\r\n                  }}\r\n                  onMouseEnter={(e) => {\r\n                    e.currentTarget.style.backgroundColor = 'rgba(43, 87, 154, 0.1)';\r\n                  }}\r\n                  onMouseLeave={(e) => {\r\n                    if (fontSize !== size) {\r\n                      e.currentTarget.style.backgroundColor = 'transparent';\r\n                    }\r\n                  }}\r\n                >\r\n                  {size}\r\n                </div>\r\n              ))}\r\n              {/* Opción de tamaño personalizado */}\r\n              <div\r\n                style={styles.customOption}\r\n                onClick={(e) => {\r\n                  e.stopPropagation();\r\n                  enableFontSizeEditing(e);\r\n                }}\r\n                onMouseEnter={(e) => {\r\n                  e.currentTarget.style.backgroundColor = 'rgba(43, 87, 154, 0.1)';\r\n                }}\r\n                onMouseLeave={(e) => {\r\n                  e.currentTarget.style.backgroundColor = 'transparent';\r\n                }}\r\n              >\r\n                Personalizado\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n        \r\n        {/* Controles de incremento/decremento */}\r\n        <div>\r\n          <button\r\n            type=\"button\"\r\n            style={styles.incrementButton}\r\n            onClick={(e) => {\r\n              e.stopPropagation();\r\n              changeFontSize(true);\r\n            }}\r\n            onMouseEnter={() => showTooltip('increaseFontSize')}\r\n            onMouseLeave={hideTooltip}\r\n          >\r\n            <span style={{ color: '#0b4444' }}>▲</span>\r\n            <Tooltip\r\n              isVisible={activeTooltip === 'increaseFontSize'}\r\n              text=\"Aumentar tamaño\"\r\n            />\r\n          </button>\r\n          <button\r\n            type=\"button\"\r\n            style={styles.incrementButton}\r\n            onClick={(e) => {\r\n              e.stopPropagation();\r\n              changeFontSize(false);\r\n            }}\r\n            onMouseEnter={() => showTooltip('decreaseFontSize')}\r\n            onMouseLeave={hideTooltip}\r\n          >\r\n            <span style={{ color: '#0b4444' }}>▼</span>\r\n            <Tooltip\r\n              isVisible={activeTooltip === 'decreaseFontSize'}\r\n              text=\"Reducir tamaño\"\r\n            />\r\n          </button>\r\n        </div>\r\n      </div>\r\n      \r\n      <div style={styles.separator} />\r\n      \r\n      {/* Opciones de formato avanzadas */}\r\n      <button \r\n        type=\"button\"\r\n        style={styles.button(false)}\r\n        onClick={() => {\r\n          restoreSelection();\r\n          onFormatText('textColor');\r\n        }}\r\n        onMouseEnter={() => showTooltip('textColor')}\r\n        onMouseLeave={hideTooltip}\r\n      >\r\n        <span style={{ color: '#0b4444' }}>A\r\n          \r\n        </span>\r\n        <Tooltip\r\n          isVisible={activeTooltip === 'textColor'}\r\n          text=\"Color de texto\"\r\n        />\r\n      </button>\r\n      <button \r\n        type=\"button\"\r\n        style={styles.button(activeFormats.unorderedList)}\r\n        onClick={() => {\r\n          restoreSelection();\r\n          onFormatText('unorderedList');\r\n        }}\r\n        onMouseEnter={() => showTooltip('unorderedList')}\r\n        onMouseLeave={hideTooltip}\r\n      >\r\n        •\r\n        <Tooltip\r\n          isVisible={activeTooltip === 'unorderedList'}\r\n          text=\"Lista con viñetas\"\r\n        />\r\n      </button>\r\n      <button \r\n        type=\"button\"\r\n        style={styles.button(activeFormats.link)}\r\n        onClick={() => {\r\n          restoreSelection();\r\n          onFormatText('link');\r\n        }}\r\n        onMouseEnter={() => showTooltip('link')}\r\n        onMouseLeave={hideTooltip}\r\n      >\r\n        <img src=\"/assets/images/icons/LINK_icon.png\" style={styles.iconImage} />\r\n        <Tooltip\r\n          isVisible={activeTooltip === 'link'}\r\n          text=\"Insertar enlace\"\r\n        />\r\n      </button>\r\n      \r\n      <button \r\n        type=\"button\"\r\n        style={styles.button(false)}\r\n        onClick={() => {\r\n          restoreSelection();\r\n          onFormatText('image');\r\n        }}\r\n        onMouseEnter={() => showTooltip('image')}\r\n        onMouseLeave={hideTooltip}\r\n      >\r\n        <img src=\"/assets/images/icons/IMG_icon.png\"  style={styles.iconImage} />\r\n        <Tooltip\r\n          isVisible={activeTooltip === 'image'}\r\n          text=\"Insertar imagen\"\r\n        />\r\n      </button>\r\n      \r\n\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default FloatingToolbar;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}